<template>
  <header class="header js-header">
  <div class="header__inner">
    <div class="header__onbg">
      <div class="headerNavWrap">
        <div class="headerNavWrap__in">
          <nav class="headerNav">
            <ul class="headerNavLists">
              <li class="headerNavLists__item nav-ani">
                <a href="./" class="headerNavLists__link is-current" data-menu="1">
                  <span class="headerNavLists__text u-font-futura">TOP</span>
                </a>
              </li>
              <li class="headerNavLists__item nav-ani">
                <a href="./news/" class="headerNavLists__link" data-menu="2">
                  <span class="headerNavLists__text u-font-futura">NEWS</span>
                </a>
              </li>
              <li class="headerNavLists__item nav-ani">
                <a href="./theater/" class="headerNavLists__link" data-menu="3">
                  <span class="headerNavLists__text u-font-futura">THEATER</span>
                </a>
              </li>
              <li class="headerNavLists__item nav-ani">
                <a href="./event/" class="headerNavLists__link" data-menu="4">
                  <span class="headerNavLists__text u-font-futura">EVENT</span>
                </a>
              </li>
              <li class="headerNavLists__item nav-ani">
                <a href="./staffcast/" class="headerNavLists__link" data-menu="5">
                  <span class="headerNavLists__text u-font-futura">STAFF&CAST</span>
                </a>
              </li>
              <li class="headerNavLists__item nav-ani">
                <a href="./story/" class="headerNavLists__link" data-menu="6">
                  <span class="headerNavLists__text u-font-futura">STORY</span>
                </a>
              </li>
              <li class="headerNavLists__item nav-ani">
                <a href="./character/" class="headerNavLists__link" data-menu="7">
                  <span class="headerNavLists__text u-font-futura">CHARACTER</span>
                </a>
              </li>
              <li class="headerNavLists__item nav-ani">
                <a href="./mecha/" class="headerNavLists__link" data-menu="8">
                  <span class="headerNavLists__text u-font-futura">MECHA</span>
                </a>
              </li>
              <li class="headerNavLists__item nav-ani">
                <a href="./keywords/" class="headerNavLists__link" data-menu="9">
                  <span class="headerNavLists__text u-font-futura">KEYWORDS</span>
                </a>
              </li>
              <li class="headerNavLists__item nav-ani">
                <a href="./music/" class="headerNavLists__link" data-menu="10">
                  <span class="headerNavLists__text u-font-futura">MUSIC</span>
                </a>
              </li>
              <li class="headerNavLists__item nav-ani">
                <a href="./gallery/" class="headerNavLists__link" data-menu="11">
                  <span class="headerNavLists__text u-font-futura">GALLERY</span>
                </a>
              </li>
            </ul>
  <div class="headerShare">
    <dl class="header__shareDl">
      <dt class="header__shareDl--dt u-font-futura">SHARE</dt>
      <dd class="header__shareDl--dd">
        <ul class="header__shareLists">
          <li class="header__shareLists--item is-twitter"><a href="https://twitter.com/share?url=https://gundam-seed.net/freedom/&text=ガンダムSEEDシリーズ最新作！【2024.1.26公開】劇場版『機動戦士ガンダムSEED%20FREEDOM』公式サイト！最新情報はここでチェック！&hashtags=SEEDFREEDOM,ガンダムSEED,g_seed" onclick="window.open(encodeURI(decodeURI(this.href)), 'tweetwindow', 'width=650, height=470, personalbar=0, toolbar=0, scrollbars=1, sizable=1'); return false;" rel="nofollow" class="is-fade-skip"><span class="hd">Twitter share</span></a></li>
          <li class="header__shareLists--item is-facebook"><a href="https://www.facebook.com/share.php?u=https://gundam-seed.net/freedom/" onclick="window.open(this.href, 'FBwindow', 'width=650, height=450, menubar=no, toolbar=no, scrollbars=yes'); return false;" class="is-fade-skip"><span class="hd">Facebook share</span></a></li>
          <li class="header__shareLists--item is-line"><a href="https://line.me/R/msg/text/?ガンダムSEEDシリーズ最新作！【2024.1.26公開】劇場版『機動戦士ガンダムSEED%20FREEDOM』公式サイト！最新情報はここでチェック！ https://gundam-seed.net/freedom/" onclick="window.open(encodeURI(decodeURI(this.href)), 'linewindow', 'width=550, height=520,personalbar=0,toolbar=0,scrollbars=1,resizable=1'); return false;" target="_blank" class="is-fade-skip"><span class="hd">LINE share</span></a></li>
        </ul>
      </dd>
    </dl>
  </div>
</nav>
</div>
</div>
<!-- /.headerNavWrap -->

<div class="header__triangle"></div>
<!-- 选项白色背景 -->
</div>
</div><!-- /.header__inner -->

  <!-- 右侧菜单栏 -->
  <div class="header__openInner">
    <div class="header__navBtnWrap">
      <!-- Menu -->
      <a href="javascript:;" class="header__navBtn js-menu">
        <div class="header__navBtn__lineWrap">
          <span class="header__navBtn--line"></span>
          <span class="header__navBtn--line"></span>
        </div>
      </a>
    </div><!-- /.header__navBtn -->
    <div class="header__sns">
      <p class="header__sns--title"><span class="u-font-futura">OFFICIAL</span></p>
      <ul class="header__sns--list">
        <li class="header__sns--item"><a href="https://twitter.com/SEED_HDRP" class="icon-tw" target="_blank"><span class="hd">Twitter</span></a></li>
        <li class="header__sns--item"><a href="https://www.tiktok.com/@seed_freedom_official" class="icon-tik" target="_blank"><span class="hd">TIKTOK</span></a></li>
      </ul>
    </div>
    <!--./header__sns-->
    <div class="header__link pc">
      <div class="header__link--item"><a href="./theater/"><span class="u-font-futura">THEATER</span><span class="icon-arrow"></span></a></div>
    </div>
    <!--./header__link-->
  </div>
</header>

<!-- <section id="firstv" class="firstv">
      <div class="firstv__inner">
        <div class="firstv__contents">
          <div class="firstv__catch pc">
            <div class="firstv__catch--item --catch-1"><img src="./assets/img/top/catch2-1.png" alt="私の中にあなたはいます。"></div>
            <div class="firstv__catch--item --catch-2"><img src="./assets/img/top/catch2-2.png" alt="あなたの中に私はいますか？"></div>
          </div>
          <div class="firstv__desc">
            <h1 class="firstv__logo"><span class="hd">劇場版『機動戦士ガンダムSEED FREEDOM』公式サイト</span></h1>
            <div class="firstv__loadshow">
              <p class="firstv__loadshow--text">
                <span class="u-font-futura">2024</span>
                <span class="u-color-blue --accent">1.26</span>
                <span class="u-font-futura --dayweek">[Fri]</span>
                <span class="u-font-futura --loadshow">ROAD SHOW</span>
              </p>
            </div>
          </div>
          <div class="firstv__sliderWrap">
            <div class="firstv__slider swiper">
              <ul class="firstv__slider--in swiper-wrapper">
                <li class="firstv__slider--item swiper-slide"><a href="https://thewonder.it/fes/3000232/description/" target="_blank"><img src="./assets/img/top/bnr/bnr_col.jpg" alt="カラーリングフェスティバル" loading="lazy"></a></li>
                <li class="firstv__slider--item swiper-slide"><a href="https://bandai-hobby.net/site/seed/seed-freedom/" target="_blank"><img src="./assets/img/top/bnr/bnr_pla.jpg" alt="「機動戦士ガンダムSEED」ガンプラ" loading="lazy"></a></li>
                <li class="firstv__slider--item swiper-slide"><a href="../onair/" target="_blank"><img src="./assets/img/top/bnr/bnr_sped2.jpg" alt="『機動戦士ガンダムSEED＆SEED DESTINY スペシャルエディション HDリマスター』TVアニメ特別総集編 各配信サービスにて配信中" loading="lazy"></a></li>
                <li class="firstv__slider--item swiper-slide"><a href="./theater/"><img src="./assets/img/top/bnr/bnr_mvtk.jpg" alt="上映劇場はこちら" loading="lazy"></a></li>
                <li class="firstv__slider--item swiper-slide"><a href="../" target="_blank"><img src="./assets/img/top/bnr/bnr_potal.jpg" alt="機動戦士ガンダムSEEDシリーズ公式サイト" loading="lazy"></a></li>
              </ul>
            </div>
            <div class="firstv__slider--pagination swiper-pagination"></div>
          </div>
        </div>
        <div class="firstv__visual">
          <div class="firstv__visual--pagination swiper-pagination"></div>
          <div class="firstv__visual--progressBar"></div>
          <div class="firstv__visual--img">
            <div class="firstv__visual--swiper swiper">
              <ul class="firstv__visual--swiper-wrapper swiper-wrapper">
                <li class="firstv__visual--swiper-slide swiper-slide">
                  <picture>
                    <source srcset="./assets/img/common/visual/main3_sp.jpg" media="screen and (max-width:768px)">
                    <img src="./assets/img/common/visual/main3.jpg" alt="劇場版『機動戦士ガンダムSEED FREEDOM』公式サイト" loading="lazy">
                  </picture>
                </li>
                <li class="firstv__visual--swiper-slide swiper-slide">
                  <picture>
                    <source srcset="./assets/img/common/visual/main2_sp.jpg" media="screen and (max-width:768px)">
                    <img src="./assets/img/common/visual/main2.jpg" alt="劇場版『機動戦士ガンダムSEED FREEDOM』公式サイト" loading="lazy">
                  </picture>
                </li>
                <li class="firstv__visual--swiper-slide swiper-slide">
                  <picture>
                    <source srcset="./assets/img/common/visual/main_sp.jpg" media="screen and (max-width:768px)">
                    <img src="./assets/img/common/visual/main.jpg" alt="劇場版『機動戦士ガンダムSEED FREEDOM』公式サイト" loading="lazy">
                  </picture>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </section> -->

    <section id="movie" class="movie js-section js-obs">
      <div class="movie__titleWrap">
        <h2 class="movie__title"><span class="u-font-futura">WELCOME</span></h2>
        <p class="movie__title--sub">
          <span class="u-font-futura">MOBILE SUIT<br>GUNDAM SEED <br class="sp">FREEDOM<br>PROMOTION VIDEO</span>
        </p>
      </div>
      <div class="movie__inner">
        <div class="movie__bg">
          <div id="js-topMovieYt"></div>
        </div>
        <div class="movie__desc">
          <h3 class="u-font-futura js-obs ani-faderight">TRAILER</h3>
          <div class="movie__link js-obs ani-faderight"><a href="./gallery/#tab-movie"><span class="u-font-futura">ARCHIVE</span><span class="icon-arrow"></span></a></div>
        </div>
        <div class="movie__triangle">
          <div class="movie__triangle--item -right"></div>
          <div class="movie__triangle--item -left"></div>
        </div>
        <div class="movie__play">
          <a href="javascript:;" class="movie__play--link js-modalOpen js-youtubePlay js-youtubeControll" data-modal="youtubeModal" data-ytid="JLPZ9uzyas0">
            <span class="movie__play--btn">
              <span class="u-font-futura">PLAY</span>
              <span class="icon-arrow-large"></span>
            </span>
          </a>
        </div>
      </div>
    </section>
    <!--./movie-->

<section id="update" class="update js-section">
      <div class="update__inner js-obs">
        <div class="update__titleWrap ani-fadeup">
          <h2 class="update__title"><span class="u-font-futura">article</span></h2>
          <p class="update__title--sub">
            <span class="u-font-futura">
              This IS<br>
              My First <br class="sp"><br>
              Website & <br class="sp">FREEDOM
            </span>
          </p>
        </div>
        <div class="update__contents">
          <div class="update__box update__news">
            <div class="update__subtitle js-obs ani-fadeup">
              <!-- <h3 class="update__subtitle--heading"><span class="u-font-futura">news</span></h3> -->
              <div class="toPage">
                <div class="update__subtitle--link toPage_left">
                  <a  @click="prevPage"><span class="u-font-futura">PREV</span><span class="icon-arrow"></span></a>
                </div>
                <div class="update__subtitle--link toPage_right">
                  <a @click="nextPage"><span class="u-font-futura">NEXT</span><span class="icon-arrow"></span></a>
                </div>
              </div>
            </div>
            <div class="left_right">
              <ul class="update__news--list">
              <li class="update__news--item js-obs ani-faderight ani-delay"
                v-for="(item, id) in showList"  
                :key="id"  
              > 
                <div @click="toNextPage(item.id)">
                  <a href="" class="update__news--link">
                    <!-- 文章标题 -->
                    <p class="update__news--title">{{ item.articleTitle }}</p> 
                    <!-- 内容介绍 -->
                    <p class="update__news--title">{{ item.articleAbstract }}</p> 
                    <!-- 创建时间 -->
                    <p class="update__news--date"> 
                      {{ item.createTime }}       <span class="update__news--arrow icon-arrow"></span>
                    </p>
                  </a>
                </div>
                <div class="updata__news--pic">
                  <img class="lazyLoad" loading="lazy" :src="getBaseImageUrl(item.imgName)" id="post-th-4603"  onerror="imgError(this,3)" data-src="http://149.88.95.15:9000/image/Liyuu.png">
                </div>
              </li>
              </ul>
              <!-- 右边栏实现移动到文章列表触发位置不随滚动条运动，到底部位置 -->
              <div class="right_introduce">
                <div class="ri_introduce_content">
                  <div class="ri_profile">
                    <img class="ri_image" src="http://149.88.95.15:9000/image/Liyuu.png" alt="">
                  </div> 
                    <div><h2 class="ri_name">anoki</h2></div>
                    <div class="ri_introduce"><p class="rt_type">你指尖跃动的电光~是我此生不变的信仰 only my reilgun。</p></div>
                    <div class="ri_icon">
                    <div class="horizontal-container">
                      <!-- <ul class="horizontal-list">  
                        <li>  
                          <span class="rt_type horizontal-type">Articles</span>  
                          <p class="rt_type horizontal-type">14</p>  
                        </li>  
                        <li>  
                          <span class="rt_type horizontal-type">talks</span>  
                          <p class="rt_type horizontal-type">1</p>  
                        </li>  
                        <li>  
                          <span class="rt_type horizontal-type">Categories</span>  
                          <p class="rt_type horizontal-type">2</p>  
                        </li>  
                        <li>  
                          <span class="rt_type horizontal-type">Tags</span>  
                          <p class="rt_type horizontal-type">5</p>  
                        </li>  
                      </ul>
                      <br> -->
                      <ul class="horizontal-list">  
                        <li>  
                          <span class="rt_type horizontal-type">Articles</span>  
                          <p class="rt_type horizontal-type">14</p>  
                        </li>  
                        <li>  
                          <span class="rt_type horizontal-type">talks</span>  
                          <p class="rt_type horizontal-type">1</p>  
                        </li>  
                        <li>  
                          <span class="rt_type horizontal-type">Categories</span>  
                          <p class="rt_type horizontal-type">2</p>  
                        </li>  
                        <li>  
                          <span class="rt_type horizontal-type">Tags</span>  
                          <p class="rt_type horizontal-type">5</p>  
                        </li>  
                      </ul>
                    </div>   
                  </div>
                </div>
                <div class="update__subtitle js-obs ani-fadeup right_introduce__title">
                  <div class="update__subtitle--link">
                    <a href="./news/"><span class="u-font-futura">露一手给你们看看</span><span class="icon-arrow"></span></a>
                  </div>
                </div>
              </div>

            </div>
            <!--./update__news--list-->
          </div>          
          </div>
        </div>
    </section>
    <!--./update-->

  <footer class="footer js-footer js-obs">
    <div class="footer__in">
    <ul class="footer__bnr--list">
      <li class="footer__bnr--item bnr-1"><a href="https://www.gundam.info/" class="ah" target="_blank"><img src="./assets/img/common/bnr/footer_bnr_01.png" alt="GUNDAM.INFO | 公式ガンダム情報ポータルサイト" loading="lazy"></a></li>
      <li class="footer__bnr--item bnr-2"><a href="https://www.youtube.com/c/GUNDAM" class="ah" target="_blank"><img src="./assets/img/common/bnr/footer_bnr_02.png" alt="ガンダムチャンネル" loading="lazy"></a></li>
      <li class="footer__bnr--item bnr-3"><a href="https://www.gundamfc.com/" class="ah" target="_blank"><img src="./assets/img/common/bnr/footer_bnr_03.png" alt="ガンダム初の公式ファンクラブ" loading="lazy"></a></li>
      <li class="footer__bnr--item bnr-4"><a href="https://gundam-navi-app.bn-ent.net/" class="ah" target="_blank"><img src="./assets/img/common/bnr/footer_bnr_04.png" alt="ガンダムナビアプリ" loading="lazy"></a></li>
    </ul>
    <!--./footer__bnrList-->
    <div class="footer__bnr--bottom"><a href="https://www.sunrise-inc.co.jp/" class="ah" target="_blank"><img src="./assets/img/common/bnr/footer_bnr_sunrise.png" alt="サンライズ｜SUNRISE" loading="lazy"></a></div>
    </div>
    <div class="footer__caution">
      <p class="footer__caution--text">
      注意：内容および画像の転載はお断りいたします。<br>お問い合せ先はこちらをご覧ください。
      </p>
      <div class="footer__caution--bottom">
        <p class="footer__caution--copy">© 創通・サンライズ</p>
        <ul class="footer__caution--link">
          <li><a href="https://www.sunrise-inc.co.jp/corporate/faq.php" target="_blank">作品情報について</a></li>
          <li><a href="https://www.bnfw.co.jp/corporate/profile/" target="_blank">会社情報について</a></li>
        </ul>
      </div>
    </div>
  </footer>
  <!--./footer-->

  <!-- 背景x1 -->
  <div class="fixbg" :id="pageid">  
    <div class="cmn__triangle">
        <div class="cmn__triangle--item -blue -top"></div>
        <div class="cmn__triangle--item -gray -bottom"></div>
    </div>
  </div>
</template>

<script lang="ts" setup>
import { ref, onMounted, onUpdated } from 'vue'
import MyIcon from '@/assest/img/common/icon/icon-arrow-large.svg'; 

// 刷新如何清空状态重新刷新？执行dom操作都需要执行一遍checkAndAddClass  
const pageid = ref('top');  
// 定义一个函数来检查 pageid 并添加类  
const checkAndAddClass = () => {
  setTimeout(()=>{
    const elements = document.querySelectorAll('.js-obs') as NodeListOf<HTMLElement>;  
    if (pageid.value === 'top') {
      document.body.classList.add('-loaded');
      elements.forEach((element) => {  
      if (!element.classList.contains('-inview')) {  
        element.classList.add('-inview');  
      }   
    })
  }  
  },0)  
};  
// 在组件挂载后执行该函数  
onMounted(checkAndAddClass);

// Menu options to Appear
function navAniAppear() {  
 // 获取所有的.nav-ani元素  
 const menuItems = document.querySelectorAll('.nav-ani');  
  // let menuTimer: number | null = null;  
  // 设置外层定时器，延迟100ms后执行  
  let menuTimer = window.setTimeout(() => {  
    // 遍历每个元素设置内部定时器
    Array.from(menuItems).forEach((($menuItem, i) => {  
      let menuItemTimer = window.setTimeout(() => {  
        $menuItem.classList.add('is-ani');  
      }, 50 * i);  
    }))
  })

}    
    
// Menu options to Leave
function navAniLeave() {  
  const menuItems = document.querySelectorAll('.nav-ani')
}  
// Menu 
document.addEventListener('DOMContentLoaded', () => {  
  const menuElement = document.querySelector('.js-menu') as HTMLElement;  
  const headerElement = document.querySelector('.js-header') as HTMLElement;  
  const logoElement = document.querySelector('.header__logo') as HTMLElement;  
  
  menuElement.addEventListener('click', () => {  
    menuElement.classList.toggle('is-active');  
  
    if (menuElement.classList.contains('is-active')) {  
      // 打开菜单  
      headerElement.classList.add('is-active');  
      // logoElement.classList.add('is-active');  
      document.body.style.overflow = 'hidden';  
  
      setTimeout(() => {  
        navAniAppear(); // 假设这是你的动画函数  
      }, 100);  
    } else {  
      // 关闭菜单  
      navAniLeave(); // 假设这是你的动画函数  
      headerElement.classList.add('is-close');  
      document.body.style.overflow = '';  
      document.documentElement.style.overflow = '';  
  
      setTimeout(() => {  
        headerElement.classList.remove('is-active');  
        // logoElement.classList.remove('is-active');  
  
        setTimeout(() => {  
          headerElement.classList.remove('is-close');  
          const navAniElements = document.querySelectorAll('.nav-ani') as NodeListOf<HTMLElement>;  
          navAniElements.forEach(el => {  
            el.classList.remove('is-leave');  
            el.classList.remove('is-ani');  
          });  
        }, 500);  
      }, 250);  
    }  
  });  
});

// Article list
import { allArticle } from '@/api/api'
const showList = ref<any[]>([]);  
const articleList = () => {
  allArticle().then(res=> {
    showList.value = res.data.data
    console.log(res.data.data[0].createTime)
  })
}
articleList()

// Page 还需要数据库总长度进行判断or查询为null判断
import { sendPageNum } from '../api/api'
let pageNum = ref(1)
const sendPageInfo = () => {
  sendPageNum(pageNum.value).then(res=> {
    // 不为null    
    if(res.data.data==null) {
      pageNum.value = pageNum.value - 1
      console.log(pageNum.value)
    } else {
      showList.value = res.data.data
      checkAndAddClass()
      console.log(showList.value)
    }
  })
}
// 初始化列表：first page
sendPageInfo()

// NEXT
const nextPage = () => {
  pageNum.value = pageNum.value+1
  // reset showList
  sendPageInfo()
}
// PREV
const prevPage = () => {
  pageNum.value = pageNum.value-1 //0=>-1
  if(pageNum.value < 1) {
    pageNum.value = 1
    sendPageInfo()
  } else {
    console.log(pageNum.value)
    // reset showList
    sendPageInfo()
  }
}

//Image
const getBaseImageUrl = (imgName:string) => {
  const baseUrl = "http://149.88.95.15:9000/image/"
  return baseUrl+imgName;
}

// to articleShow
import { useRouter } from 'vue-router'
const router = useRouter(); 
const toNextPage = (id:number) => {
  // console.log(id)
  router.push({ name: 'articleShow', params: { id:id } });  
  // console.log(id)
}
</script>

<style scoped>
 @import '../assest/css/common.css';
 @import '../assest/css/articleList.css'
</style>